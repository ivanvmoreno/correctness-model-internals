schema: '2.0'
stages:
  format_datasets:
    cmd: python -m src.stages.format_datasets --config=params.yaml
    deps:
    - path: ./datasets/raw/
      hash: md5
      md5: dc007414179c80b25fa562388134de22.dir
      size: 277862800
      nfiles: 194
    - path: src/stages/format_datasets.py
      hash: md5
      md5: 4621c30e8ce731ccc342e103de5c6ff0
      size: 2591
    params:
      params.yaml:
        base:
          project_name: correctness-model-internals
          log_level: DEBUG
          models_dir: ../models
          datasets_dir: ./datasets
          generations_dir: ./generations
          evaluations_dir: ./evaluations
          activations_dir: ./activations
          classification_stats_dir: ./classification_stats
        datasets:
          gsm8k:
            answer_type: open_ended
            answer_delim: '####'
            answer_regex: (?<=\$\\boxed\{)\d+(?=\}\$)
            eval_type: regex_match
            max_new_tokens: 1024
            stop_words:
            - '}$'
            subsets:
            - main
            prompts:
              base_3_shot:
                text: "Give your answer in this format: $\\boxed{answer}$\nHere are
                  some examples to help you understand the format:\n---\nQuestion:
                  Weng earns $12 an hour for babysitting. Yesterday, she just did
                  50 minutes of babysitting. How much did she earn?\nAnswer: $\\boxed{10}$\n
                  ---\nQuestion: Julie is reading a 120-page book. Yesterday, she
                  was able to read 12 pages and today, she read twice as many pages
                  as yesterday. If she wants to read half of the remaining pages tomorrow,
                  how many pages should she read?\nAnswer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nAnswer: $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Answer:'
              cot_3_shot:
                text: "Think step by step about the following problem.\nGive your
                  answer in this format: $\\boxed{answer}$\nHere are some examples
                  to help you understand the format:\n---\nQuestion: Weng earns $12
                  an hour for babysitting. Yesterday, she just did 50 minutes of babysitting.
                  How much did she earn?\nReasoning: Weng earns 12/60 = $12/60=0.20.2
                  per minute. Working 50 minutes, she earned 0.2 x 50 = $0.2*50=1010.\n
                  Final answer: $\\boxed{10}$\n---\nQuestion: Julie is reading a 120-page
                  book. Yesterday, she was able to read 12 pages and today, she read
                  twice as many pages as yesterday. If she wants to read half of the
                  remaining pages tomorrow, how many pages should she read?\nReasoning:
                  Julie read 12 x 2 = 12*2=2424 pages today. So she was able to read
                  a total of 12 + 24 = 12+24=3636 pages since yesterday. There are
                  120 - 36 = 120-36=8484 pages left to be read. Since she wants to
                  read half of the remaining pages tomorrow, then she should read
                  84/2 = 84/2=4242 pages.\nFinal answer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nReasoning: There are 80/100 * 10 = 80/100*10=88 more
                  purple flowers than yellow flowers. So in Mark's garden, there are
                  10 + 8 = 10+8=1818 purple flowers. Purple and yellow flowers sum
                  up to 10 + 18 = 10+18=2828 flowers. That means in Mark's garden
                  there are 25/100 * 28 = 25/100*28=77 green flowers. So in total
                  Mark has 28 + 7 = 28+7=3535 plants in his garden.\nFinal answer:
                  $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Reasoning:'
        format_datasets:
          raw_dir_path: raw
          formatted_dir_path: formatted
          generation_delimiter: 'Answer:'
    outs:
    - path: ./datasets/formatted/
      hash: md5
      md5: 2deaca978faa21f9420e9721768417b3.dir
      size: 26530422
      nfiles: 2
  generate_answers:
    cmd: python -m src.stages.generate_answers --config=params.yaml --model=llama3.1_8b_chat
      --batch-size=100
    deps:
    - path: ./datasets/formatted/
      hash: md5
      md5: 2deaca978faa21f9420e9721768417b3.dir
      size: 26530422
      nfiles: 2
    - path: src/stages/generate_answers.py
      hash: md5
      md5: 8b4e65e9887f7411f50060d500b99b99
      size: 9272
    params:
      params.yaml:
        base:
          project_name: correctness-model-internals
          log_level: DEBUG
          models_dir: ../models
          datasets_dir: ./datasets
          generations_dir: ./generations
          evaluations_dir: ./evaluations
          activations_dir: ./activations
          classification_stats_dir: ./classification_stats
        datasets:
          gsm8k:
            answer_type: open_ended
            answer_delim: '####'
            answer_regex: (?<=\$\\boxed\{)\d+(?=\}\$)
            eval_type: regex_match
            max_new_tokens: 1024
            stop_words:
            - '}$'
            subsets:
            - main
            prompts:
              base_3_shot:
                text: "Give your answer in this format: $\\boxed{answer}$\nHere are
                  some examples to help you understand the format:\n---\nQuestion:
                  Weng earns $12 an hour for babysitting. Yesterday, she just did
                  50 minutes of babysitting. How much did she earn?\nAnswer: $\\boxed{10}$\n
                  ---\nQuestion: Julie is reading a 120-page book. Yesterday, she
                  was able to read 12 pages and today, she read twice as many pages
                  as yesterday. If she wants to read half of the remaining pages tomorrow,
                  how many pages should she read?\nAnswer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nAnswer: $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Answer:'
              cot_3_shot:
                text: "Think step by step about the following problem.\nGive your
                  answer in this format: $\\boxed{answer}$\nHere are some examples
                  to help you understand the format:\n---\nQuestion: Weng earns $12
                  an hour for babysitting. Yesterday, she just did 50 minutes of babysitting.
                  How much did she earn?\nReasoning: Weng earns 12/60 = $12/60=0.20.2
                  per minute. Working 50 minutes, she earned 0.2 x 50 = $0.2*50=1010.\n
                  Final answer: $\\boxed{10}$\n---\nQuestion: Julie is reading a 120-page
                  book. Yesterday, she was able to read 12 pages and today, she read
                  twice as many pages as yesterday. If she wants to read half of the
                  remaining pages tomorrow, how many pages should she read?\nReasoning:
                  Julie read 12 x 2 = 12*2=2424 pages today. So she was able to read
                  a total of 12 + 24 = 12+24=3636 pages since yesterday. There are
                  120 - 36 = 120-36=8484 pages left to be read. Since she wants to
                  read half of the remaining pages tomorrow, then she should read
                  84/2 = 84/2=4242 pages.\nFinal answer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nReasoning: There are 80/100 * 10 = 80/100*10=88 more
                  purple flowers than yellow flowers. So in Mark's garden, there are
                  10 + 8 = 10+8=1818 purple flowers. Purple and yellow flowers sum
                  up to 10 + 18 = 10+18=2828 flowers. That means in Mark's garden
                  there are 25/100 * 28 = 25/100*28=77 green flowers. So in total
                  Mark has 28 + 7 = 28+7=3535 plants in his garden.\nFinal answer:
                  $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Reasoning:'
        format_datasets:
          raw_dir_path: raw
          formatted_dir_path: formatted
          generation_delimiter: 'Answer:'
        generate_answers:
          model: llama3.1_8b_chat
          max_dataset_size: false
          sample_strategy: first_n
          generation_batch_size: 100
          activations_batch_size: 10
          inference_engine: vllm
    outs:
    - path: ./generations/
      hash: md5
      md5: 75824b676fdc5d78ab53c427d9f3e463.dir
      size: 29065022
      nfiles: 2
  evaluate_answers:
    cmd: python -m src.stages.evaluate_answers --config=params.yaml --model=llama3.1_8b_chat
    deps:
    - path: ./datasets/formatted/
      hash: md5
      md5: 2deaca978faa21f9420e9721768417b3.dir
      size: 26530422
      nfiles: 2
    - path: ./generations/
      hash: md5
      md5: 75824b676fdc5d78ab53c427d9f3e463.dir
      size: 29065022
      nfiles: 2
    - path: src/stages/evaluate_answers.py
      hash: md5
      md5: a3bca029e24153f2840bf0c87e12d608
      size: 8544
    params:
      params.yaml:
        base:
          project_name: correctness-model-internals
          log_level: DEBUG
          models_dir: ../models
          datasets_dir: ./datasets
          generations_dir: ./generations
          evaluations_dir: ./evaluations
          activations_dir: ./activations
          classification_stats_dir: ./classification_stats
        datasets:
          gsm8k:
            answer_type: open_ended
            answer_delim: '####'
            answer_regex: (?<=\$\\boxed\{)\d+(?=\}\$)
            eval_type: regex_match
            max_new_tokens: 1024
            stop_words:
            - '}$'
            subsets:
            - main
            prompts:
              base_3_shot:
                text: "Give your answer in this format: $\\boxed{answer}$\nHere are
                  some examples to help you understand the format:\n---\nQuestion:
                  Weng earns $12 an hour for babysitting. Yesterday, she just did
                  50 minutes of babysitting. How much did she earn?\nAnswer: $\\boxed{10}$\n
                  ---\nQuestion: Julie is reading a 120-page book. Yesterday, she
                  was able to read 12 pages and today, she read twice as many pages
                  as yesterday. If she wants to read half of the remaining pages tomorrow,
                  how many pages should she read?\nAnswer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nAnswer: $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Answer:'
              cot_3_shot:
                text: "Think step by step about the following problem.\nGive your
                  answer in this format: $\\boxed{answer}$\nHere are some examples
                  to help you understand the format:\n---\nQuestion: Weng earns $12
                  an hour for babysitting. Yesterday, she just did 50 minutes of babysitting.
                  How much did she earn?\nReasoning: Weng earns 12/60 = $12/60=0.20.2
                  per minute. Working 50 minutes, she earned 0.2 x 50 = $0.2*50=1010.\n
                  Final answer: $\\boxed{10}$\n---\nQuestion: Julie is reading a 120-page
                  book. Yesterday, she was able to read 12 pages and today, she read
                  twice as many pages as yesterday. If she wants to read half of the
                  remaining pages tomorrow, how many pages should she read?\nReasoning:
                  Julie read 12 x 2 = 12*2=2424 pages today. So she was able to read
                  a total of 12 + 24 = 12+24=3636 pages since yesterday. There are
                  120 - 36 = 120-36=8484 pages left to be read. Since she wants to
                  read half of the remaining pages tomorrow, then she should read
                  84/2 = 84/2=4242 pages.\nFinal answer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nReasoning: There are 80/100 * 10 = 80/100*10=88 more
                  purple flowers than yellow flowers. So in Mark's garden, there are
                  10 + 8 = 10+8=1818 purple flowers. Purple and yellow flowers sum
                  up to 10 + 18 = 10+18=2828 flowers. That means in Mark's garden
                  there are 25/100 * 28 = 25/100*28=77 green flowers. So in total
                  Mark has 28 + 7 = 28+7=3535 plants in his garden.\nFinal answer:
                  $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Reasoning:'
        format_datasets:
          raw_dir_path: raw
          formatted_dir_path: formatted
          generation_delimiter: 'Answer:'
        generate_answers:
          model: llama3.1_8b_chat
          max_dataset_size: false
          sample_strategy: first_n
          generation_batch_size: 100
          activations_batch_size: 10
          inference_engine: vllm
    outs:
    - path: ./evaluations/
      hash: md5
      md5: 0a348907a59947f52dea27521ad3b96b.dir
      size: 29221990
      nfiles: 5
  capture_activations:
    cmd: python -m src.stages.capture_activations --config=params.yaml --model=llama3.1_8b_chat
      --batch-size=10
    deps:
    - path: ./generations/
      hash: md5
      md5: 75824b676fdc5d78ab53c427d9f3e463.dir
      size: 29065022
      nfiles: 2
    - path: src/stages/capture_activations.py
      hash: md5
      md5: 74b16989da5bf2519dfef951b5777827
      size: 5734
    params:
      params.yaml:
        base:
          project_name: correctness-model-internals
          log_level: DEBUG
          models_dir: ../models
          datasets_dir: ./datasets
          generations_dir: ./generations
          evaluations_dir: ./evaluations
          activations_dir: ./activations
          classification_stats_dir: ./classification_stats
        capture_activations:
          input_type:
          - prompt_only
          - prompt_answer
        datasets:
          gsm8k:
            answer_type: open_ended
            answer_delim: '####'
            answer_regex: (?<=\$\\boxed\{)\d+(?=\}\$)
            eval_type: regex_match
            max_new_tokens: 1024
            stop_words:
            - '}$'
            subsets:
            - main
            prompts:
              base_3_shot:
                text: "Give your answer in this format: $\\boxed{answer}$\nHere are
                  some examples to help you understand the format:\n---\nQuestion:
                  Weng earns $12 an hour for babysitting. Yesterday, she just did
                  50 minutes of babysitting. How much did she earn?\nAnswer: $\\boxed{10}$\n
                  ---\nQuestion: Julie is reading a 120-page book. Yesterday, she
                  was able to read 12 pages and today, she read twice as many pages
                  as yesterday. If she wants to read half of the remaining pages tomorrow,
                  how many pages should she read?\nAnswer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nAnswer: $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Answer:'
              cot_3_shot:
                text: "Think step by step about the following problem.\nGive your
                  answer in this format: $\\boxed{answer}$\nHere are some examples
                  to help you understand the format:\n---\nQuestion: Weng earns $12
                  an hour for babysitting. Yesterday, she just did 50 minutes of babysitting.
                  How much did she earn?\nReasoning: Weng earns 12/60 = $12/60=0.20.2
                  per minute. Working 50 minutes, she earned 0.2 x 50 = $0.2*50=1010.\n
                  Final answer: $\\boxed{10}$\n---\nQuestion: Julie is reading a 120-page
                  book. Yesterday, she was able to read 12 pages and today, she read
                  twice as many pages as yesterday. If she wants to read half of the
                  remaining pages tomorrow, how many pages should she read?\nReasoning:
                  Julie read 12 x 2 = 12*2=2424 pages today. So she was able to read
                  a total of 12 + 24 = 12+24=3636 pages since yesterday. There are
                  120 - 36 = 120-36=8484 pages left to be read. Since she wants to
                  read half of the remaining pages tomorrow, then she should read
                  84/2 = 84/2=4242 pages.\nFinal answer: $\\boxed{42}$\n---\nQuestion:
                  Mark has a garden with flowers. He planted plants of three different
                  colors in it. Ten of them are yellow, and there are 80% more of
                  those in purple. There are only 25% as many green flowers as there
                  are yellow and purple flowers. How many flowers does Mark have in
                  his garden?\nReasoning: There are 80/100 * 10 = 80/100*10=88 more
                  purple flowers than yellow flowers. So in Mark's garden, there are
                  10 + 8 = 10+8=1818 purple flowers. Purple and yellow flowers sum
                  up to 10 + 18 = 10+18=2828 flowers. That means in Mark's garden
                  there are 25/100 * 28 = 25/100*28=77 green flowers. So in total
                  Mark has 28 + 7 = 28+7=3535 plants in his garden.\nFinal answer:
                  $\\boxed{35}$\n---\nQuestion:"
                generation_delimiter: 'Reasoning:'
        generate_answers:
          model: llama3.1_8b_chat
          max_dataset_size: false
          sample_strategy: first_n
          generation_batch_size: 100
          activations_batch_size: 10
          inference_engine: vllm
        models:
          llama3.1_8b_chat:
            dir_path: llama3.1_8b_chat
            eos_token: <\|eot_id\|>
            max_length: 1024
          llama3_8b_cot:
            dir_path: llama3_8b_cot_numina_hf
            eos_token: <\|eot_id\|>
            max_length: 1024
          llama3_3b_chat:
            dir_path: llama3_3b_chat_hf
            max_length: 1024
    outs:
    - path: ./activations/
      hash: md5
      md5: a12e60cefddae4f6455bf274bc10c9bc.dir
      size: 18585842304
      nfiles: 112640
